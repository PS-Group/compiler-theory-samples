# Примеры на C++ для STL и Lemon

Все примеры используют последний на момент публикации стандарт C++ (**C++ 2014**). Код примеров призван показать современные технологии и приёмы в построении компиляторов и интерпретаторов. С другой стороны, мы не ставим своей целью показать современный подход к построению архитектуры приложений &mdash; поэтому в отдельных местах код может быть намерено упрощённым. Тем не менее, мы заботимся о корректности и краткости примеров кода.

### Синтаксический анализ с генератором парсеров Lemon

Lemon &mdash; это генератор парсеров, использующих алгоритм LALR для разбора. Генератор принимает на вход аттрибутную BNF-грамматику. В сравнении с Bison:

- плюсы: Lemon генерирует более чистый код на C, имеет систему деструкторов правил.
- минусы: Lemon не поддерживает EBNF, только упрощённый BNF. Это раздувает код.

Примеры последовательно шаг за шагом выращивают интерпретатор.

* `lemon-1-calculator` реализует калькулятор арифметических выражений: "`1 + 2*(7 /21)`"
* `lemon-2-interpreter` реализует многострочный интерпретатор выражений с поддержкой переменных
* `lemon-3-error-recovery` добавляет восстановление после ошибок разбора
* `lemon-4-ast` создаёт абстрактное синтаксическое дерево (AST) и интерпретирует его
* `lemon-5-minimal-structured` добавляет простейший элемент структурного программирования: инструкцию `if` без ветки `else`.
* `lemon-6-full-structured` добавляет новые элементы структурного программирования: циклы `while` и `repeat .. until`, опциональный `else` для `if`.
* `lemon-7-functions` добавляет элементы процедурного программирования: пользовательские функции с аргументами, встроенные функции `sin` и `rand`, инструкцию `return`, выражение вызова функции, области видимости переменных в функциях
* `lemon-8-types` добавляет динамическую типизацию: ранее был доступен только тип Number, теперь же можно использовать `String`, `Number` и `Boolean`, поддерживаются все старые бинарные операции и вывод через `print`, добавлены новые операторы сравнения `<` и `==`.
* `lemon-8-types` добавляет финальные улучшения: логические операторы дизьюнкции, коньюнкци и отрицания; список выражений произвольной длины в `print`.

#### Подробнее о Lemon

- [Реализация парсера C на Lemon (codeproject.com)](http://www.codeproject.com/Articles/1056460/Generating-a-High-Speed-Parser-Part-Lemon)
- [Lemon-грамматика в исходном коде SQLite (github.com)](https://github.com/mackyle/sqlite/blob/master/src/parse.y)
- [Ещё одна Lemon-грамматика в исходном коде SQLite (github.com)](https://github.com/mackyle/sqlite/blob/master/ext/fts5/fts5parse.y)

### Лексический анализ и разбор на базе C++ STL
* `std-regex` показывает, как применять стандартный класс регулярных выражений `std::regex` для сопоставления входной строки с образцом или для построчного сканирования ввода.
* `std-stringview` показывает, как использовать стандартный класс невладеющей ссылки на строку `std::string_view` для разбора арифметического выражения.
